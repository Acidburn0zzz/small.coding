<rules name="Secure Configuration Baseline">
  <settings>
    <!-- The ORACLE_SID value is passed on, the rest needs to be set in XML file -->
    <setting name="INITFILE" value="/etc/opt/oracle/${ORACLE_SID}/pfile/init${ORACLE_SID}.ora" />
    <setting name="LISTENER" value="${TNS_ADMIN}/listener.ora" />
  </settings>
  <filters>
    <filtergroup name="OS">
      <filter id="hp-ux" cmd="/bin/uname" output="HP-UX" />
      <filter id="sunos" cmd="/bin/uname" output="SunOS" />
    </filtergroup>
    <filtergroup name="PLATFORM">
      <filter id="unix" cmd="/usr/bin/true" output="" />
    </filtergroup>
  </filters>
  <rule id="1">
  	<contentmatch file="/etc/passwd" match="^oracle:\*:">
  	  <usefilter name="OS" value="hp-ux" />
  	</contentmatch>
	<contentmatch file="/etc/shadow" match="^oracle:\*LK\*">
	  <usefilter name="OS" value="sunos" />
	</contentmatch>
  </rule>
  <rule id="3">
    <sqloutput cmd="select banner from v\$version where banner like 'CORE%';" expression="CORE[ &#09;]*\([0-9\.]*\).*" output="\1" />
  </rule>
  <rule id="5">
  	<privilegematch file="${ORACLE_HOME}/bin/tkprof" match="-rwxr-xr-x">
  	  <usefilter name="PLATFORM" value="unix" />
  	</privilegematch>
  </rule>
  <rule id="6">
    <contentnomatch file="${LISTENER}" match="LISTENER_ORCL =">
      <usefilter name="PLATFORM" value="unix" />
    </contentnomatch>
  </rule>
  <comment>
  <rule id="7">
    <chain type="foreachfile" location="${ORACLE_HOME}/otrace/admin/*.dat">
      <privilegematch match="----------">
      	<usefilter name="PLATFORM" value="unix" />
      </privilegematch>
    </chain>
  </rule>
  </comment>
  <rule id="8">
    <contentnomatch file="${LISTENER}" match="PASSWORD">
      <usefilter name="PLATFORM" value="unix" />
    </contentnomatch>
  </rule>
  <comment>
  <rule id="14">
    <chain type="foreachfile" location="${ORACLE_HOME}/bin/*">
      <ownershipmatch match="oracle:dba">
        <usefilter name="unix" />
      </ownershipmatch>
    </chain>
  </rule>
  <rule id="15">
    <chain type="foreachfile" location="${ORACLE_HOME}/bin/*">
      <privilegematch match="-rwxr-xr-x">
        <usefilter name="PLATFORM" value="unix" />
      </privilegematch>
    </chain>
  </rule>
  </comment>
  <rule id="18">
    <ownershipmatch file="${INITFILE}" match="oracle:dba">
      <usefilter name="PLATFORM" value="unix" />
    </ownershipmatch>
  </rule>
  <rule id="19">
    <privilegematch file="${INITFILE}" match="-rw-r-----">
      <usefilter name="PLATFORM" value="unix" />
    </privilegematch>
  </rule>
  <rule id="20">
    <chain type="foreachsqlvaluelocation" command="select value from v\$parameter where name='spfile';">
      <ownershipmatch match="oracle:dba">
        <usefilter name="PLATFORM" value="unix" />
      </ownershipmatch>
    </chain>
  </rule>
  <rule id="21">
    <chain type="foreachsqlvaluelocation" command="select value from v\$parameter where name='spfile';">
      <privilegematch match="-rw-r-----">
        <usefilter name="PLATFORM" value="unix" />
      </privilegematch>
    </chain>
  </rule>
  <rule id="22">
    <chain type="foreachsqlvaluelocation" command="select name from v\$datafile;">
      <ownershipmatch match="oracle:dba">
        <usefilter name="PLATFORM" value="unix" />
      </ownershipmatch>
    </chain>
  </rule>
</rules>
