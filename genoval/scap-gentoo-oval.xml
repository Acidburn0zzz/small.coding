<?xml version="1.0"?>
<oval_definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
 xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
 xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5"
 xmlns:ind-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent"
 xmlns:lin-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux"
 xmlns:unix-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix">
  <generator>
    <oval:product_name>vim</oval:product_name>
    <oval:schema_version>5.9</oval:schema_version>
    <oval:timestamp>2011-10-31T12:00:00-04:00</oval:timestamp>
  </generator>

<definitions>
  <definition class="compliance" id="oval:org.gentoo.dev.swift:def:1" version="1">
    <metadata>
      <title>The /tmp mount is mounted with nosuid</title>
      <description>
        The /tmp location should be mounted with nosuid.
      </description>
    </metadata>
    <criteria>
      <criterion test_ref="oval:org.gentoo.dev.swift:tst:1" comment="Check if /tmp is mounted with nosuid" />
    </criteria>
  </definition>
  <definition class="compliance" id="oval:org.gentoo.dev.swift:def:2" version="1">
    <metadata>
      <title>The /tmp mount is a tmpfs file system with nosuid, noexec</title>
      <description>
        The /tmp location should be a tmpfs file system, which ensures that
        the data on this location is removed during shutdown or reboot. It should
        be mounted with nosuid and noexec mount options.
      </description>
    </metadata>
    <criteria>
      <criterion test_ref="oval:org.gentoo.dev.swift:tst:2" comment="Check in /etc/fstab for /tmp as tmpfs with nosuid,noexec" />
    </criteria>
  </definition>
  <definition class="compliance" id="oval:org.gentoo.dev.swift:def:3" version="1">
    <metadata>
      <title>Non-physical terminals are not defined in securetty</title>
      <description>
        The root user should not be allowed to log on any other way than through
	the console or the physical terminals. So any vc/* terminal should be
	excluded from the securetty file.
      </description>
    </metadata>
    <criteria>
      <criterion test_ref="oval:org.gentoo.dev.swift:tst:3" comment="Only console and tty/* should be mentioned in securetty" />
    </criteria>
  </definition>
  <definition class="compliance" id="oval:org.gentoo.dev.swift:def:4" version="1">
    <metadata>
      <title>/home should be on a separate partition</title>
      <description>
        To support specific mount options and quota, /home needs to be on its own
	partition.
      </description>
    </metadata>
    <criteria>
      <criterion test_ref="oval:org.gentoo.dev.swift:tst:4" comment="Test if /home is on a separate partition" />
    </criteria>
  </definition>
  <definition class="compliance" id="oval:org.gentoo.dev.swift:def:5" version="1">
    <metadata>
      <title>The /home mount is mounted with nodev</title>
      <description>
        The /home location should be mounted with nodev.
      </description>
    </metadata>
    <criteria>
      <criterion test_ref="oval:org.gentoo.dev.swift:tst:5" comment="Check if /home is mounted with nodev" />
    </criteria>
  </definition>
  <definition class="compliance" id="oval:org.gentoo.dev.swift:def:6" version="1">
    <metadata>
      <title>The /tmp mount is mounted with nodev</title>
      <description>
        The /tmp location should be mounted with nodev.
      </description>
    </metadata>
    <criteria>
      <criterion test_ref="oval:org.gentoo.dev.swift:tst:6" comment="Check if /home is mounted with nodev" />
    </criteria>
  </definition>
  <definition class="compliance" id="oval:org.gentoo.dev.swift:def:7" version="1">
    <metadata>
      <title>The /tmp mount is mounted with nosuid</title>
      <description>
        The /tmp location should be mounted with nosuid.
      </description>
    </metadata>
    <criteria>
      <criterion test_ref="oval:org.gentoo.dev.swift:tst:7" comment="Check if /home is mounted with nodev" />
    </criteria>
  </definition>
  <definition class="compliance" id="oval:org.gentoo.dev.swift:def:8" version="1">
    <metadata>
      <title>The /home mount is mounted with nodev</title>
      <description>
        The /home location should be mounted with nodev.
      </description>
    </metadata>
    <criteria>
      <criterion test_ref="oval:org.gentoo.dev.swift:tst:8" comment="Check if /home is mounted with nodev" />
    </criteria>
  </definition>

</definitions>

<tests>
  <!-- /home is mounted with nosuid -->
  <lin-def:partition_test id="oval:org.gentoo.dev.swift:tst:1" version="1" check="all" comment="check if /home is mounted with nosuid" check_existence="at_least_one_exists">
    <lin-def:object object_ref="oval:org.gentoo.dev.swift:obj:1" />
    <lin-def:state state_ref="oval:org.gentoo.dev.swift:ste:5" />
  </lin-def:partition_test>
  <!-- /tmp is a tmpfs -->
  <lin-def:partition_test id="oval:org.gentoo.dev.swift:tst:2" version="1" check="all" comment="look for /tmp as tmpfs in /etc/fstab" check_existence="at_least_one_exists">
    <lin-def:object object_ref="oval:org.gentoo.dev.swift:obj:2" />
    <lin-def:state state_ref="oval:org.gentoo.dev.swift:ste:4" />
  </lin-def:partition_test>

  <!-- Only 'console' and tty/* are mentioned in securetty -->
  <ind-def:textfilecontent54_test check="all" check_existence="none_exist" id="oval:org.gentoo.dev.swift:tst:3" version="1" comment="look for wrong terminal declarations in securetty (only console and tty* should be supported)">
    <ind-def:object object_ref="oval:org.gentoo.dev.swift:obj:3" />
  </ind-def:textfilecontent54_test>
  <!-- /home is a separate partition -->
  <lin-def:partition_test id="oval:org.gentoo.dev.swift:tst:4" version="1" check="all" comment="look for a /home partition" check_existence="at_least_one_exists">
    <lin-def:object object_ref="oval:org.gentoo.dev.swift:obj:1" />
  </lin-def:partition_test>
  <!-- /home is mounted with nodev -->
  <lin-def:partition_test id="oval:org.gentoo.dev.swift:tst:5" version="1" check="all" comment="check if /home is mounted with nodev" check_existence="at_least_one_exists">
    <lin-def:object object_ref="oval:org.gentoo.dev.swift:obj:1" />
    <lin-def:state state_ref="oval:org.gentoo.dev.swift:ste:7" />
  </lin-def:partition_test>

  <!-- /tmp is mounted with nosuid -->
  <lin-def:partition_test id="oval:org.gentoo.dev.swift:tst:6" version="1" check="all" comment="look for /tmp as tmpfs in /etc/fstab" check_existence="at_least_one_exists">
    <lin-def:object object_ref="oval:org.gentoo.dev.swift:obj:2" />
    <lin-def:state state_ref="oval:org.gentoo.dev.swift:ste:5" />
  </lin-def:partition_test>

  <!-- /tmp is mounted with nodev -->
  <lin-def:partition_test id="oval:org.gentoo.dev.swift:tst:7" version="1" check="all" comment="look for /tmp as tmpfs in /etc/fstab" check_existence="at_least_one_exists">
    <lin-def:object object_ref="oval:org.gentoo.dev.swift:obj:2" />
    <lin-def:state state_ref="oval:org.gentoo.dev.swift:ste:7" />
  </lin-def:partition_test>

  <!-- /tmp is mounted with noexec -->
  <lin-def:partition_test id="oval:org.gentoo.dev.swift:tst:8" version="1" check="all" comment="look for /tmp as tmpfs in /etc/fstab" check_existence="at_least_one_exists">
    <lin-def:object object_ref="oval:org.gentoo.dev.swift:obj:2" />
    <lin-def:state state_ref="oval:org.gentoo.dev.swift:ste:6" />
  </lin-def:partition_test>

</tests>

<objects>	
  <!-- /home partition -->
  <lin-def:partition_object id="oval:org.gentoo.dev.swift:obj:1" version="1" comment="The /home partition definition">
    <lin-def:mount_point>/home</lin-def:mount_point>
  </lin-def:partition_object>
  <!-- /tmp partition -->
  <lin-def:partition_object id="oval:org.gentoo.dev.swift:obj:2" version="1" comment="The /tmp partition definition">
    <lin-def:mount_point>/tmp</lin-def:mount_point>
  </lin-def:partition_object>
  <!-- /etc/securetty file -->
  <ind-def:textfilecontent54_object id="oval:org.gentoo.dev.swift:obj:3" version="1" comment="The /etc/securetty file">
    <ind-def:filepath>/etc/securetty</ind-def:filepath>
    <ind-def:pattern operation="pattern match">^[\s]*(vc\/[0-9]+|ttyS[0-9]+)[\S]*(#.*)?$</ind-def:pattern>
    <ind-def:instance datatype="int" operation="greater than or equal">1</ind-def:instance>
  </ind-def:textfilecontent54_object>

</objects>


<states>
  <!-- File system is tmpfs, mounted with nosuid and noexec -->
  <lin-def:partition_state id="oval:org.gentoo.dev.swift:ste:4" version="1" comment="The file system is tmpfs">
    <lin-def:fs_type>TMPFS_MAGIC</lin-def:fs_type>
  </lin-def:partition_state>
  <lin-def:partition_state id="oval:org.gentoo.dev.swift:ste:5" version="1" comment="The mount option nosuid is set">
    <lin-def:mount_options entity_check="at least one">nosuid</lin-def:mount_options>
  </lin-def:partition_state>
  <lin-def:partition_state id="oval:org.gentoo.dev.swift:ste:6" version="1" comment="The mount option noexec is set">
    <lin-def:mount_options entity_check="at least one">noexec</lin-def:mount_options>
  </lin-def:partition_state>
  <lin-def:partition_state id="oval:org.gentoo.dev.swift:ste:7" version="1" comment="The mount option nodev is set">
    <lin-def:mount_options entity_check="at least one">nodev</lin-def:mount_options>
  </lin-def:partition_state>
</states>

</oval_definitions>

