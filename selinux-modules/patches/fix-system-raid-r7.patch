--- refpolicy.orig/policy/modules/system/raid.te	2010-08-03 15:11:04.000000000 +0200
+++ refpolicy/policy/modules/system/raid.te	2011-02-01 17:03:55.955000006 +0100
@@ -52,6 +52,7 @@
 dev_read_realtime_clock(mdadm_t)
 # unfortunately needed for DMI decoding:
 dev_read_raw_memory(mdadm_t)
+dev_rw_sysfs(mdadm_t)
 
 domain_use_interactive_fds(mdadm_t)
 
@@ -69,6 +70,9 @@
 storage_dev_filetrans_fixed_disk(mdadm_t)
 storage_read_scsi_generic(mdadm_t)
 
+allow mdadm_t device_t:blk_file { read ioctl };
+allow mdadm_t device_t:dir { create };
+
 term_dontaudit_list_ptys(mdadm_t)
 
 init_dontaudit_getattr_initctl(mdadm_t)
@@ -83,6 +87,12 @@
 
 mta_send_mail(mdadm_t)
 
+ifdef(`distro_gentoo',`
+	tunable_policy(`gentoo_try_dontaudit',`
+		files_dontaudit_getattr_all_files(mdadm_t)
+	')
+')
+
 optional_policy(`
 	gpm_dontaudit_getattr_gpmctl(mdadm_t)
 ')
