--- refpolicy/policy/modules/contrib/networkmanager.te	2012-05-31 13:27:04.268069371 +0200
+++ refpolicypolicy/modules/contrib/networkmanager.te	2012-05-31 13:25:21.543069152 +0200
@@ -71,11 +71,6 @@
 manage_sock_files_pattern(NetworkManager_t, NetworkManager_var_run_t, NetworkManager_var_run_t)
 files_pid_filetrans(NetworkManager_t, NetworkManager_var_run_t, { dir file sock_file })
 
-manage_dirs_pattern(wpa_cli_t, wpa_cli_var_run_t, wpa_cli_var_run_t)
-manage_files_pattern(wpa_cli_t, wpa_cli_var_run_t, wpa_cli_var_run_t)
-manage_sock_files_pattern(wpa_cli_t, wpa_cli_var_run_t, wpa_cli_var_run_t)
-files_pid_filetrans(wpa_cli_t, wpa_cli_var_run_t, { dir file sock_file })
-
 kernel_read_system_state(NetworkManager_t)
 kernel_read_network_state(NetworkManager_t)
 kernel_read_kernel_sysctls(NetworkManager_t)
@@ -133,12 +128,10 @@
 init_read_utmp(NetworkManager_t)
 init_dontaudit_write_utmp(NetworkManager_t)
 init_domtrans_script(NetworkManager_t)
-init_domtrans_script(wpa_cli_t)
 
 auth_use_nsswitch(NetworkManager_t)
 
 logging_send_syslog_msg(NetworkManager_t)
-logging_send_syslog_msg(wpa_cli_t)
 
 miscfiles_read_localization(NetworkManager_t)
 miscfiles_read_generic_certs(NetworkManager_t)
@@ -159,8 +152,6 @@
 
 userdom_dontaudit_use_unpriv_user_fds(NetworkManager_t)
 userdom_dontaudit_use_user_ttys(NetworkManager_t)
-userdom_use_user_ttys(wpa_cli_t)
-userdom_use_user_ptys(wpa_cli_t)
 # Read gnome-keyring
 userdom_read_user_home_content_files(NetworkManager_t)
 
@@ -293,27 +284,38 @@
 list_dirs_pattern(wpa_cli_t, NetworkManager_var_run_t, NetworkManager_var_run_t)
 rw_sock_files_pattern(wpa_cli_t, NetworkManager_var_run_t, NetworkManager_var_run_t)
 
-init_dontaudit_use_fds(wpa_cli_t)
-init_use_script_ptys(wpa_cli_t)
+manage_files_pattern(wpa_cli_t, wpa_cli_var_run_t, wpa_cli_var_run_t)
+files_pid_filetrans(wpa_cli_t, wpa_cli_var_run_t, file)
 
-miscfiles_read_localization(wpa_cli_t)
+corecmd_exec_bin(wpa_cli_t)
+corecmd_exec_shell(wpa_cli_t)
 
-term_dontaudit_use_console(wpa_cli_t)
+domain_use_interactive_fds(wpa_cli_t)
+
+files_search_pids(wpa_cli_t)
 
-fs_search_tmpfs(wpa_cli_t)
-fs_search_tmpfs(NetworkManager_t)
-fs_rw_tmpfs_files(wpa_cli_t)
-fs_rw_tmpfs_files(NetworkManager_t)
 fs_manage_tmpfs_dirs(wpa_cli_t)
 fs_manage_tmpfs_sockets(wpa_cli_t)
 fs_manage_tmpfs_sockets(NetworkManager_t)
+fs_rw_tmpfs_files(wpa_cli_t)
+fs_rw_tmpfs_files(NetworkManager_t)
+fs_search_tmpfs(wpa_cli_t)
+fs_search_tmpfs(NetworkManager_t)
+
+term_dontaudit_use_console(wpa_cli_t)
+
 getty_use_fds(wpa_cli_t)
-files_search_pids(wpa_cli_t)
-corecmd_exec_shell(wpa_cli_t)
-corecmd_exec_bin(wpa_cli_t)
-domain_use_interactive_fds(wpa_cli_t)
+
+init_domtrans_script(wpa_cli_t)
+init_dontaudit_use_fds(wpa_cli_t)
+init_use_script_ptys(wpa_cli_t)
+
+logging_send_syslog_msg(wpa_cli_t)
+
+miscfiles_read_localization(wpa_cli_t)
+
+userdom_use_user_terminals(wpa_cli_t)
 
 ifdef(`distro_gentoo',`
        sysnet_domtrans_dhcpc(wpa_cli_t)
-       allow wpa_cli_t etc_t:file { getattr };
 ')
