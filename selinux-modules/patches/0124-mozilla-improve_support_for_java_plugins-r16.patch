--- refpolicy/policy/modules/contrib/mozilla.te	2012-07-23 21:26:16.794412605 +0200
+++ refpolicypolicy/modules/contrib/mozilla.te	2012-07-23 21:25:49.072412559 +0200
@@ -82,6 +82,7 @@
 allow mozilla_t mozilla_conf_t:file read_file_perms;
 
 manage_files_pattern(mozilla_t, mozilla_tmp_t, mozilla_tmp_t)
+manage_fifo_files_pattern(mozilla_t, mozilla_tmp_t, mozilla_tmp_t)
 manage_dirs_pattern(mozilla_t, mozilla_tmp_t, mozilla_tmp_t)
 files_tmp_filetrans(mozilla_t, mozilla_tmp_t, { file dir })
 
@@ -274,7 +275,7 @@
 ')
 
 optional_policy(`
-	java_domtrans(mozilla_t)
+	java_noatsecure_domtrans(mozilla_t)
 ')
 
 optional_policy(`
--- refpolicy/policy/modules/contrib/mozilla.if	2012-07-23 21:26:16.793412605 +0200
+++ refpolicypolicy/modules/contrib/mozilla.if	2012-07-23 18:01:14.563386347 +0200
@@ -60,6 +60,27 @@
 ##	</summary>
 ## </param>
 #
+interface(`mozilla_read_user_home',`
+	gen_require(`
+		type mozilla_home_t;
+	')
+
+	list_dirs_pattern($1, mozilla_home_t, mozilla_home_t)
+	read_files_pattern($1, mozilla_home_t, mozilla_home_t)
+	userdom_search_user_home_dirs($1)
+')
+
+
+########################################
+## <summary>
+##	Read mozilla home directory files
+## </summary>
+## <param name="domain">
+##	<summary>
+##	Domain allowed access.
+##	</summary>
+## </param>
+#
 interface(`mozilla_read_user_home_files',`
 	gen_require(`
 		type mozilla_home_t;
@@ -300,3 +321,21 @@
 
 	allow $1 mozilla_plugin_tmpfs_t:file unlink;
 ')
+
+########################################
+## <summary>
+##	Read/write to mozilla's tmp fifo files
+## </summary>
+## <param name="domain">
+##	<summary>
+##	Domain allowed access
+##	</summary>
+## </param>
+#
+interface(`mozilla_rw_tmp_pipes',`
+	gen_require(`
+		type mozilla_tmp_t;
+	')
+
+	rw_fifo_files_pattern($1, mozilla_tmp_t, mozilla_tmp_t)
+')
