--- refpolicy/policy/modules/contrib/portage.if	2011-10-25 19:20:03.000000000 +0200
+++ refpolicy/policy/modules/contrib/portage.if	2012-02-25 11:06:47.794314427 +0100
@@ -361,3 +361,33 @@
 
 	dontaudit $1 portage_tmp_t:file rw_file_perms;
 ')
+
+########################################
+## <summary>
+##   Allow the domain to run within an eselect module script. 
+## </summary>
+## <param name="domain">
+##     <summary>
+##     Domain to allow within an eselect module
+##     </summary>
+## </param>
+#   Specific to Gentoo,
+#   eselect modules allow users to switch between different flavors or versions
+#   of underlying components. In return, eselect makes a wrapper binary which 
+#   makes the proper selections. If this binary is different from bin_t, it might
+#   not hold the necessary privileges for the wrapper to function. However, just
+#   marking the target binaries doesn't always work, since for python scripts the
+#   wrapper doesn't execute it, but treats the target as a library.
+#
+interface(`gentoo_portage_eselect_module',`
+       gen_require(`
+               type portage_t;
+       ')
+       allow $1 self:fifo_file { read write };
+
+       corecmd_exec_shell($1)  
+
+       # Support for /etc/env.d changes
+       files_manage_etc_runtime_files($1)
+')
+
